<%- include('partials/header') -%>

<div class="flex pt-6 justify-center items-center antialiased">
  <div class="flex items-center justify-center flex-col">
    <h1 class="pb-5">
      Welcome <%= user.name %>, this is your dashboard. Here you can add new entries and visualize
      your calorie intake
    </h1>
    <button
      id="openButton"
      class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 border rounded-full"
    >
      New entry
    </button>
  </div>
</div>

<div
  class="fixed hidden inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full"
  id="submitModal"
>
  <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
    <div class="mt-3 text-center">
      <div class="mt-2 px-7 py-3"></div>

      <form action="/dashboard/entry" class="flex flex-col space-y-4" method="POST">
        <div>
          <label for="">Calorie intake</label>

          <input
            name="intake"
            type="number"
            placeholder="Kcal"
            class="mt-2 w-full rounded-md px-4 py-2 outline-none ring-1 ring-gray-300 focus:ring-2 focus:ring-teal-300"
          />
        </div>
        <div>
          <label for="weight">Weight</label>

          <input
            name="weight"
            type="number"
            placeholder="Weight in pounds"
            class="mt-2 w-full rounded-md px-4 py-2 outline-none ring-1 ring-gray-300 focus:ring-2 focus:ring-teal-300"
          />
        </div>
        <button
          type="submit"
          id="addButton"
          class="inline-block w-56 self-center rounded-md bg-green-500 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-300"
        >
          Add
        </button>
      </form>
    </div>
  </div>
</div>

<div class="flex justify-center items-center">
  <div class="flex w-1/2 items-center p-2">
    <canvas id="myChart"></canvas>
  </div>
  <div class="flex w-2/2 items-center p-2">
    <canvas id="myChart2"></canvas>
  </div>
</div>

<script>
  let entryForm = document.getElementById('submitModal');

  let openButton = document.getElementById('openButton');

  let addButton = document.getElementById('addButton');

  openButton.onclick = function () {
    entryForm.style.display = 'block';
  };
  // We want the modal to close when the OK button is clicked
  addButton.onclick = function () {
    entryForm.style.display = 'none';
  };

  window.onclick = function (event) {
    if (event.target == entryForm) {
      entryForm.style.display = 'none';
    }
  };

  // chart js
  const labels = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];
  const labels2 = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

  const intakeData = {
    labels: labels,
    datasets: [
      {
        label: 'Daily intake',
        backgroundColor: 'rgb(255, 99, 132)',
        borderColor: 'rgb(255, 99, 132)',
        data: <%- JSON.stringify(intake) %>,
      },
    ],
  };
  const weightData = {
    labels: labels2,
    datasets: [
      {
        label: 'Weight',
        backgroundColor: 'rgb(255, 99, 132)',
        borderColor: 'rgb(255, 99, 132)',
        data: <%- JSON.stringify(weight) %>,
      },
    ],
  };

  const intakeConfig = {
    type: 'line',
    data: intakeData,
    options: {},
  };
  const weightConfig = {
    type: 'line',
    data: weightData,
    options: {},
  };

  const myChart = new Chart(document.getElementById('myChart'), intakeConfig);
  const myChart2 = new Chart(document.getElementById('myChart2'), weightConfig);
</script>
